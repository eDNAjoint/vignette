<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Use case 1: basic use of jointModel() | eDNAjoint: an R package for interpreting paired or semi-paired environmental DNA and traditional survey data in a Bayesian framework</title>
  <meta name="description" content="Chapter 3 Use case 1: basic use of jointModel() | eDNAjoint: an R package for interpreting paired or semi-paired environmental DNA and traditional survey data in a Bayesian framework" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Use case 1: basic use of jointModel() | eDNAjoint: an R package for interpreting paired or semi-paired environmental DNA and traditional survey data in a Bayesian framework" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bookdown.org/abigailkeller/eDNAjoint/images/eDNAjoint_logo.png" />
  
  <meta name="github-repo" content="abigailkeller/eDNAjoint" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Use case 1: basic use of jointModel() | eDNAjoint: an R package for interpreting paired or semi-paired environmental DNA and traditional survey data in a Bayesian framework" />
  
  
  <meta name="twitter:image" content="https://bookdown.org/abigailkeller/eDNAjoint/images/eDNAjoint_logo.png" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="installation.html"/>
<link rel="next" href="usecase2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">eDNAjoint</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a></li>
<li class="chapter" data-level="3" data-path="usecase1.html"><a href="usecase1.html"><i class="fa fa-check"></i><b>3</b> Use case 1: basic use of <code>jointModel()</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="usecase1.html"><a href="usecase1.html#prepare-the-data"><i class="fa fa-check"></i><b>3.1</b> Prepare the data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="usecase1.html"><a href="usecase1.html#longtowide"><i class="fa fa-check"></i><b>3.1.1</b> Converting data from long to wide</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="usecase1.html"><a href="usecase1.html#fit-the-model"><i class="fa fa-check"></i><b>3.2</b> Fit the model</a></li>
<li class="chapter" data-level="3.3" data-path="usecase1.html"><a href="usecase1.html#model-selection"><i class="fa fa-check"></i><b>3.3</b> Model selection</a></li>
<li class="chapter" data-level="3.4" data-path="usecase1.html"><a href="usecase1.html#interpret-the-output"><i class="fa fa-check"></i><b>3.4</b> Interpret the output</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="usecase1.html"><a href="usecase1.html#summarize-posterior-distributions"><i class="fa fa-check"></i><b>3.4.1</b> Summarize posterior distributions</a></li>
<li class="chapter" data-level="3.4.2" data-path="usecase1.html"><a href="usecase1.html#effort-necessary-to-detect-presence"><i class="fa fa-check"></i><b>3.4.2</b> Effort necessary to detect presence</a></li>
<li class="chapter" data-level="3.4.3" data-path="usecase1.html"><a href="usecase1.html#calculate-mu_critical"><i class="fa fa-check"></i><b>3.4.3</b> Calculate <span class="math inline">\(\mu_{critical}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="usecase1.html"><a href="usecase1.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>3.5</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="3.6" data-path="usecase1.html"><a href="usecase1.html#initialvalues1"><i class="fa fa-check"></i><b>3.6</b> Initial values</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="usecase2.html"><a href="usecase2.html"><i class="fa fa-check"></i><b>4</b> Use case 2: <code>jointModel()</code> with site-level covariates</a>
<ul>
<li class="chapter" data-level="4.1" data-path="usecase2.html"><a href="usecase2.html#fit-the-model-1"><i class="fa fa-check"></i><b>4.1</b> Fit the model</a></li>
<li class="chapter" data-level="4.2" data-path="usecase2.html"><a href="usecase2.html#model-selection-1"><i class="fa fa-check"></i><b>4.2</b> Model selection</a></li>
<li class="chapter" data-level="4.3" data-path="usecase2.html"><a href="usecase2.html#interpret-the-output-1"><i class="fa fa-check"></i><b>4.3</b> Interpret the output</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="usecase2.html"><a href="usecase2.html#summarize-posterior-distributions-1"><i class="fa fa-check"></i><b>4.3.1</b> Summarize posterior distributions</a></li>
<li class="chapter" data-level="4.3.2" data-path="usecase2.html"><a href="usecase2.html#effort-necessary-to-detect-presence-1"><i class="fa fa-check"></i><b>4.3.2</b> Effort necessary to detect presence</a></li>
<li class="chapter" data-level="4.3.3" data-path="usecase2.html"><a href="usecase2.html#calculate-mu_critical-1"><i class="fa fa-check"></i><b>4.3.3</b> Calculate <span class="math inline">\(\mu_{critical}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="usecase2.html"><a href="usecase2.html#initialvalues2"><i class="fa fa-check"></i><b>4.4</b> Initial values</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="usecase3.html"><a href="usecase3.html"><i class="fa fa-check"></i><b>5</b> Use case 3: <code>jointModel()</code> with multiple traditional gear types</a>
<ul>
<li class="chapter" data-level="5.1" data-path="usecase3.html"><a href="usecase3.html#prepare-the-data-1"><i class="fa fa-check"></i><b>5.1</b> Prepare the data</a></li>
<li class="chapter" data-level="5.2" data-path="usecase3.html"><a href="usecase3.html#fit-the-model-2"><i class="fa fa-check"></i><b>5.2</b> Fit the model</a></li>
<li class="chapter" data-level="5.3" data-path="usecase3.html"><a href="usecase3.html#model-selection-2"><i class="fa fa-check"></i><b>5.3</b> Model selection</a></li>
<li class="chapter" data-level="5.4" data-path="usecase3.html"><a href="usecase3.html#interpret-the-output-2"><i class="fa fa-check"></i><b>5.4</b> Interpret the output</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="usecase3.html"><a href="usecase3.html#summarize-posterior-distributions-2"><i class="fa fa-check"></i><b>5.4.1</b> Summarize posterior distributions</a></li>
<li class="chapter" data-level="5.4.2" data-path="usecase3.html"><a href="usecase3.html#effort-necessary-to-detect-presence-2"><i class="fa fa-check"></i><b>5.4.2</b> Effort necessary to detect presence</a></li>
<li class="chapter" data-level="5.4.3" data-path="usecase3.html"><a href="usecase3.html#calculate-mu_critical-2"><i class="fa fa-check"></i><b>5.4.3</b> Calculate <span class="math inline">\(\mu_{critical}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="usecase3.html"><a href="usecase3.html#traditionalmodel"><i class="fa fa-check"></i><b>5.5</b> traditionalModel()</a></li>
<li class="chapter" data-level="5.6" data-path="usecase3.html"><a href="usecase3.html#initialvalues3"><i class="fa fa-check"></i><b>5.6</b> Initial values</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="usecase4.html"><a href="usecase4.html"><i class="fa fa-check"></i><b>6</b> Use case 4: <code>jointModel()</code> with semi-paired data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="usecase4.html"><a href="usecase4.html#simulate-semi-paired-data"><i class="fa fa-check"></i><b>6.1</b> Simulate semi-paired data</a></li>
<li class="chapter" data-level="6.2" data-path="usecase4.html"><a href="usecase4.html#prepare-the-data-2"><i class="fa fa-check"></i><b>6.2</b> Prepare the data</a></li>
<li class="chapter" data-level="6.3" data-path="usecase4.html"><a href="usecase4.html#fit-the-model-3"><i class="fa fa-check"></i><b>6.3</b> Fit the model</a></li>
<li class="chapter" data-level="6.4" data-path="usecase4.html"><a href="usecase4.html#interpret-the-output-3"><i class="fa fa-check"></i><b>6.4</b> Interpret the output</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="usecase4.html"><a href="usecase4.html#summarize-posterior-distributions-3"><i class="fa fa-check"></i><b>6.4.1</b> Summarize posterior distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="usecase4.html"><a href="usecase4.html#initialvalues4"><i class="fa fa-check"></i><b>6.5</b> Initial values</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="model.html"><a href="model.html"><i class="fa fa-check"></i><b>7</b> The model</a>
<ul>
<li class="chapter" data-level="7.1" data-path="model.html"><a href="model.html#modeldescription"><i class="fa fa-check"></i><b>7.1</b> Model description</a></li>
<li class="chapter" data-level="7.2" data-path="model.html"><a href="model.html#bayesian-modeling-stan"><i class="fa fa-check"></i><b>7.2</b> Bayesian modeling: Stan</a></li>
<li class="chapter" data-level="7.3" data-path="model.html"><a href="model.html#priors"><i class="fa fa-check"></i><b>7.3</b> Priors</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tips.html"><a href="tips.html"><i class="fa fa-check"></i><b>8</b> Tips</a>
<ul>
<li class="chapter" data-level="8.1" data-path="tips.html"><a href="tips.html#visualization-tips"><i class="fa fa-check"></i><b>8.1</b> Visualization tips</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="tips.html"><a href="tips.html#posterior-samples"><i class="fa fa-check"></i><b>8.1.1</b> Posterior samples</a></li>
<li class="chapter" data-level="8.1.2" data-path="tips.html"><a href="tips.html#chain-convergence"><i class="fa fa-check"></i><b>8.1.2</b> Chain convergence</a></li>
<li class="chapter" data-level="8.1.3" data-path="tips.html"><a href="tips.html#shinystan"><i class="fa fa-check"></i><b>8.1.3</b> Shinystan</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="tips.html"><a href="tips.html#troubleshooting-tips"><i class="fa fa-check"></i><b>8.2</b> Troubleshooting tips</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="tips.html"><a href="tips.html#quick-tips"><i class="fa fa-check"></i><b>8.2.1</b> Quick tips</a></li>
<li class="chapter" data-level="8.2.2" data-path="tips.html"><a href="tips.html#initial-values"><i class="fa fa-check"></i><b>8.2.2</b> Initial values</a></li>
<li class="chapter" data-level="8.2.3" data-path="tips.html"><a href="tips.html#changing-priors"><i class="fa fa-check"></i><b>8.2.3</b> Changing priors</a></li>
<li class="chapter" data-level="8.2.4" data-path="tips.html"><a href="tips.html#adding-site-level-covariates"><i class="fa fa-check"></i><b>8.2.4</b> Adding site-level covariates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="citation.html"><a href="citation.html"><i class="fa fa-check"></i><b>9</b> Citation</a></li>
<li class="chapter" data-level="10" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>10</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">eDNAjoint: an R package for interpreting paired or semi-paired environmental DNA and traditional survey data in a Bayesian framework</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="usecase1" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Use case 1: basic use of <code>jointModel()</code><a href="usecase1.html#usecase1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This first use case will show how to fit and interpret the joint model with paired eDNA and traditional survey data.</p>
<p><br></p>
<p><img src="images/basic_diagram_final-01.png" width="50%" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>The data used in this example comes from a study by Schmelzle and Kinziger (2016) about endangered tidewater gobies (<em>Eucyclogobius newberryi</em>) in California. Environmental DNA samples were collected at 39 sites, along with paired traditional seine sampling. The eDNA data is detection/non-detection data generated through quantitative polymerase chain reaction (qPCR).</p>
<div id="prepare-the-data" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Prepare the data<a href="usecase1.html#prepare-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Both eDNA and traditional survey data should have a hierarchical structure:</p>
<ul>
<li>Sites (primary sample units) within a study area</li>
<li>eDNA and traditional samples (secondary sample units) collected from each site</li>
<li>eDNA subsamples (replicate observations) taken from each eDNA sample</li>
</ul>
<p>Ensuring that your data is formatted correctly is essential for successfully using <em>eDNAjoint</em>. Let’s first explore the structure of the goby data.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="usecase1.html#cb3-1" tabindex="-1"></a><span class="fu">library</span>(eDNAjoint)</span>
<span id="cb3-2"><a href="usecase1.html#cb3-2" tabindex="-1"></a><span class="fu">data</span>(gobyData)</span>
<span id="cb3-3"><a href="usecase1.html#cb3-3" tabindex="-1"></a><span class="fu">str</span>(gobyData)</span></code></pre></div>
<pre><code>## List of 4
##  $ qPCR.N  : num [1:39, 1:22] 6 6 6 6 6 6 6 6 6 6 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:22] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ qPCR.K  : num [1:39, 1:22] 0 0 0 0 6 0 0 0 0 5 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:22] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ count   : int [1:39, 1:22] 0 0 0 0 0 0 0 0 0 1 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:22] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ site.cov: num [1:39, 1:5] -0.711 -0.211 -1.16 -0.556 -0.988 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:5] &quot;Salinity&quot; &quot;Filter_time&quot; &quot;Other_fishes&quot; &quot;Hab_size&quot; ...</code></pre>
<p>You can see that the data is a list of four matrices all with the same number of rows that represent each site (n=39). Across all matrices, rows in the data should correspond to the same sites (i.e., row one in all matrices corresponds to site one, and row 31 in all matrices corresponds to site 31).</p>
<p><code>qPCR.K</code>, <code>qPCR.N</code>, and <code>count</code> are required for all implementations of <code>jointModel()</code>, and <code>site.cov</code> is optional and will be used in <a href="usecase2.html#usecase2">use case 2</a>.</p>
<p>Let’s look first at <code>qPCR.K</code>. These are the total number of positive qPCR detections for each site (row) and eDNA sample (column). The number of columns should equal the maximum number of eDNA samples collected at any site. Blank spaces are filled with NA at sites where fewer eDNA samples were collected than the maximum.</p>
<p>For example, at site one, 11 eDNA samples were collected, and at site five, 20 eDNA samples were collected.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="usecase1.html#cb5-1" tabindex="-1"></a><span class="fu">head</span>(gobyData<span class="sc">$</span>qPCR.K)</span></code></pre></div>
<pre><code>##      1 2 3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22
## [1,] 0 0 0  0  0  0  0  0  0  0  0 NA NA NA NA NA NA NA NA NA NA NA
## [2,] 0 0 0  0  0  0  0  0  0  0  0 NA NA NA NA NA NA NA NA NA NA NA
## [3,] 0 0 0  0  0  0  0  0  0  0  0 NA NA NA NA NA NA NA NA NA NA NA
## [4,] 0 6 6  4  6  5  4  6  5  3 NA NA NA NA NA NA NA NA NA NA NA NA
## [5,] 6 6 4  6  6  6  5  4  2  2  0  6  5  5  6  6  6  5  5  4 NA NA
## [6,] 0 0 0 NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA</code></pre>
<p>Now let’s look at <code>qPCR.N</code>. These are the total number of qPCR eDNA subsamples (replicate observations) collected for each site (row) and eDNA sample (column). In this data, six qPCR replicate observations were collected for each eDNA sample. Notice that the locations of the NAs in the matrix match <code>qPCR.K</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="usecase1.html#cb7-1" tabindex="-1"></a><span class="fu">head</span>(gobyData<span class="sc">$</span>qPCR.N)</span></code></pre></div>
<pre><code>##      1 2 3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22
## [1,] 6 6 6  6  6  6  6  6  6  6  6 NA NA NA NA NA NA NA NA NA NA NA
## [2,] 6 6 6  6  6  6  6  6  6  6  6 NA NA NA NA NA NA NA NA NA NA NA
## [3,] 6 6 6  6  6  6  6  6  6  6  6 NA NA NA NA NA NA NA NA NA NA NA
## [4,] 6 6 6  6  6  6  6  6  6  6 NA NA NA NA NA NA NA NA NA NA NA NA
## [5,] 6 6 6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6  6 NA NA
## [6,] 6 6 6 NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA</code></pre>
<p>Next, let’s look at <code>count</code>. This data is from seine sampling for tidewater gobies. Each integer refers to the catch of each seine sample (i.e., catch per unit effort, when effort = 1). Again, the rows correspond to sites, and the columns refer to replicated seine samples (secondary sample units) at each site, with a maximum of 22 samples. Blank spaces are filled with NA at sites where fewer seine samples were collected than the maximum.</p>
<p>In this example, the count data are integers, but continuous values can be used in the model (see Eq. 1.3 in the <a href="model.html#modeldescription">model description</a>).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="usecase1.html#cb9-1" tabindex="-1"></a><span class="fu">head</span>(gobyData<span class="sc">$</span>count)</span></code></pre></div>
<pre><code>##      1 2 3  4  5  6  7   8  9 10 11 12 13 14 15 16 17 18 19 20 21 22
## [1,] 0 0 0  0  0  0  0   0  0  0  0 NA NA NA NA NA NA NA NA NA NA NA
## [2,] 0 0 0  0  0  0  0   0  0  0  0 NA NA NA NA NA NA NA NA NA NA NA
## [3,] 0 0 0  0  0  0  0   0  0  0  0 NA NA NA NA NA NA NA NA NA NA NA
## [4,] 0 4 1  0  2  1 38 112  1 15 NA NA NA NA NA NA NA NA NA NA NA NA
## [5,] 0 0 0  2  0  0  0   0  0  0  0  0  4  1  0  2  0  8 NA NA NA NA
## [6,] 0 0 0 NA NA NA NA  NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA</code></pre>
<div id="longtowide" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Converting data from long to wide<a href="usecase1.html#longtowide" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using <code>eDNAjoint</code> requires your data to be in “wide” format. Wide vs. long data refers to the shape of your data in tidyverse jargon (see more <a href="https://tavareshugo.github.io/r-intro-tidyverse-gapminder/09-reshaping/index.html">here</a>). Below is an example for how to convert your data to wide format.</p>
<p>First let’s simulate “long” qPCR data.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="usecase1.html#cb11-1" tabindex="-1"></a><span class="do">## data dimensions</span></span>
<span id="cb11-2"><a href="usecase1.html#cb11-2" tabindex="-1"></a><span class="co"># number of sites (primary sample units)</span></span>
<span id="cb11-3"><a href="usecase1.html#cb11-3" tabindex="-1"></a>nsite <span class="ot">&lt;-</span> <span class="dv">4</span> </span>
<span id="cb11-4"><a href="usecase1.html#cb11-4" tabindex="-1"></a><span class="co"># number of eDNA samples (secondary sample units)</span></span>
<span id="cb11-5"><a href="usecase1.html#cb11-5" tabindex="-1"></a>neDNA_samples <span class="ot">&lt;-</span> <span class="dv">6</span> </span>
<span id="cb11-6"><a href="usecase1.html#cb11-6" tabindex="-1"></a><span class="co"># number of traditional samples (secondary sample units)</span></span>
<span id="cb11-7"><a href="usecase1.html#cb11-7" tabindex="-1"></a>ntraditional_subsamples <span class="ot">&lt;-</span> <span class="dv">8</span> </span>
<span id="cb11-8"><a href="usecase1.html#cb11-8" tabindex="-1"></a><span class="co"># number of eDNA subsamples (replicate observations)</span></span>
<span id="cb11-9"><a href="usecase1.html#cb11-9" tabindex="-1"></a>neDNA_subsamples <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb11-10"><a href="usecase1.html#cb11-10" tabindex="-1"></a></span>
<span id="cb11-11"><a href="usecase1.html#cb11-11" tabindex="-1"></a><span class="co"># simulate qPCR data</span></span>
<span id="cb11-12"><a href="usecase1.html#cb11-12" tabindex="-1"></a>qPCR_long <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-13"><a href="usecase1.html#cb11-13" tabindex="-1"></a>  <span class="at">site =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>nsite, <span class="at">each =</span> neDNA_samples),</span>
<span id="cb11-14"><a href="usecase1.html#cb11-14" tabindex="-1"></a>  <span class="at">eDNA_sample =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>neDNA_samples, <span class="at">times =</span> nsite),</span>
<span id="cb11-15"><a href="usecase1.html#cb11-15" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">rep</span>(neDNA_subsamples, nsite<span class="sc">*</span>neDNA_samples),</span>
<span id="cb11-16"><a href="usecase1.html#cb11-16" tabindex="-1"></a>  <span class="at">K =</span> <span class="fu">c</span>(</span>
<span id="cb11-17"><a href="usecase1.html#cb11-17" tabindex="-1"></a>    <span class="fu">rbinom</span>(neDNA_samples, neDNA_subsamples, <span class="fl">0.1</span>), <span class="co"># site 1 positive detections</span></span>
<span id="cb11-18"><a href="usecase1.html#cb11-18" tabindex="-1"></a>    <span class="fu">rbinom</span>(neDNA_samples, neDNA_subsamples, <span class="fl">0.6</span>), <span class="co"># site 2 positive detections</span></span>
<span id="cb11-19"><a href="usecase1.html#cb11-19" tabindex="-1"></a>    <span class="fu">rbinom</span>(neDNA_samples, neDNA_subsamples, <span class="dv">0</span>), <span class="co"># site 3 positive detections</span></span>
<span id="cb11-20"><a href="usecase1.html#cb11-20" tabindex="-1"></a>    <span class="fu">rbinom</span>(neDNA_samples, neDNA_subsamples, <span class="fl">0.4</span>) <span class="co"># site 4 positive detections</span></span>
<span id="cb11-21"><a href="usecase1.html#cb11-21" tabindex="-1"></a>  )</span>
<span id="cb11-22"><a href="usecase1.html#cb11-22" tabindex="-1"></a>)</span>
<span id="cb11-23"><a href="usecase1.html#cb11-23" tabindex="-1"></a></span>
<span id="cb11-24"><a href="usecase1.html#cb11-24" tabindex="-1"></a><span class="fu">head</span>(qPCR_long)</span></code></pre></div>
<pre><code>##   site eDNA_sample N K
## 1    1           1 3 0
## 2    1           2 3 0
## 3    1           3 3 0
## 4    1           4 3 1
## 5    1           5 3 0
## 6    1           6 3 1</code></pre>
<p>And simulate “long” traditional data:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="usecase1.html#cb13-1" tabindex="-1"></a><span class="co"># simulate traditional count data</span></span>
<span id="cb13-2"><a href="usecase1.html#cb13-2" tabindex="-1"></a>count_long <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-3"><a href="usecase1.html#cb13-3" tabindex="-1"></a>  <span class="at">site =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>nsite, <span class="at">each =</span> ntraditional_subsamples),</span>
<span id="cb13-4"><a href="usecase1.html#cb13-4" tabindex="-1"></a>  <span class="at">traditional_sample =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>ntraditional_subsamples, <span class="at">times =</span> nsite),</span>
<span id="cb13-5"><a href="usecase1.html#cb13-5" tabindex="-1"></a>  <span class="at">count =</span> <span class="fu">c</span>(</span>
<span id="cb13-6"><a href="usecase1.html#cb13-6" tabindex="-1"></a>    <span class="fu">rpois</span>(ntraditional_subsamples, <span class="fl">0.5</span>), <span class="co"># site 1 count data</span></span>
<span id="cb13-7"><a href="usecase1.html#cb13-7" tabindex="-1"></a>    <span class="fu">rpois</span>(ntraditional_subsamples, <span class="dv">4</span>), <span class="co"># site 2 count data</span></span>
<span id="cb13-8"><a href="usecase1.html#cb13-8" tabindex="-1"></a>    <span class="fu">rpois</span>(ntraditional_subsamples, <span class="dv">0</span>), <span class="co"># site 3 count data</span></span>
<span id="cb13-9"><a href="usecase1.html#cb13-9" tabindex="-1"></a>    <span class="fu">rpois</span>(ntraditional_subsamples, <span class="dv">2</span>) <span class="co"># site 4 count data</span></span>
<span id="cb13-10"><a href="usecase1.html#cb13-10" tabindex="-1"></a>  )</span>
<span id="cb13-11"><a href="usecase1.html#cb13-11" tabindex="-1"></a>)</span>
<span id="cb13-12"><a href="usecase1.html#cb13-12" tabindex="-1"></a></span>
<span id="cb13-13"><a href="usecase1.html#cb13-13" tabindex="-1"></a><span class="fu">head</span>(count_long)</span></code></pre></div>
<pre><code>##   site traditional_sample count
## 1    1                  1     1
## 2    1                  2     0
## 3    1                  3     1
## 4    1                  4     1
## 5    1                  5     0
## 6    1                  6     1</code></pre>
<p>Now let’s convert the data from “long” to “wide”.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="usecase1.html#cb15-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="usecase1.html#cb16-1" tabindex="-1"></a><span class="co"># N: number of qPCR eDNA subsamples (i.e., replicate observations) </span></span>
<span id="cb16-2"><a href="usecase1.html#cb16-2" tabindex="-1"></a><span class="co"># per eDNA sample (i.e., secondary sample)</span></span>
<span id="cb16-3"><a href="usecase1.html#cb16-3" tabindex="-1"></a>qPCR_N_wide <span class="ot">&lt;-</span> qPCR_long <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="usecase1.html#cb16-4" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols=</span>site,</span>
<span id="cb16-5"><a href="usecase1.html#cb16-5" tabindex="-1"></a>              <span class="at">names_from=</span>eDNA_sample,</span>
<span id="cb16-6"><a href="usecase1.html#cb16-6" tabindex="-1"></a>              <span class="at">values_from=</span>N) <span class="sc">%&gt;%</span> </span>
<span id="cb16-7"><a href="usecase1.html#cb16-7" tabindex="-1"></a>  <span class="fu">arrange</span>(site) <span class="sc">%&gt;%</span> </span>
<span id="cb16-8"><a href="usecase1.html#cb16-8" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>site)</span>
<span id="cb16-9"><a href="usecase1.html#cb16-9" tabindex="-1"></a></span>
<span id="cb16-10"><a href="usecase1.html#cb16-10" tabindex="-1"></a><span class="co"># K: number of positive qPCR detections in each </span></span>
<span id="cb16-11"><a href="usecase1.html#cb16-11" tabindex="-1"></a><span class="co"># eDNA sample (i.e., secondary sample)</span></span>
<span id="cb16-12"><a href="usecase1.html#cb16-12" tabindex="-1"></a>qPCR_K_wide <span class="ot">&lt;-</span> qPCR_long <span class="sc">%&gt;%</span> </span>
<span id="cb16-13"><a href="usecase1.html#cb16-13" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols=</span>site,</span>
<span id="cb16-14"><a href="usecase1.html#cb16-14" tabindex="-1"></a>              <span class="at">names_from=</span>eDNA_sample,</span>
<span id="cb16-15"><a href="usecase1.html#cb16-15" tabindex="-1"></a>              <span class="at">values_from=</span>K) <span class="sc">%&gt;%</span> </span>
<span id="cb16-16"><a href="usecase1.html#cb16-16" tabindex="-1"></a>  <span class="fu">arrange</span>(site) <span class="sc">%&gt;%</span> </span>
<span id="cb16-17"><a href="usecase1.html#cb16-17" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>site)</span>
<span id="cb16-18"><a href="usecase1.html#cb16-18" tabindex="-1"></a></span>
<span id="cb16-19"><a href="usecase1.html#cb16-19" tabindex="-1"></a><span class="co"># count: number of individuals in each traditional sample </span></span>
<span id="cb16-20"><a href="usecase1.html#cb16-20" tabindex="-1"></a><span class="co"># (i.e., secondary sample)</span></span>
<span id="cb16-21"><a href="usecase1.html#cb16-21" tabindex="-1"></a>count_wide <span class="ot">&lt;-</span> count_long <span class="sc">%&gt;%</span> </span>
<span id="cb16-22"><a href="usecase1.html#cb16-22" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols=</span>site,</span>
<span id="cb16-23"><a href="usecase1.html#cb16-23" tabindex="-1"></a>              <span class="at">names_from=</span>traditional_sample,</span>
<span id="cb16-24"><a href="usecase1.html#cb16-24" tabindex="-1"></a>              <span class="at">values_from=</span>count) <span class="sc">%&gt;%</span> </span>
<span id="cb16-25"><a href="usecase1.html#cb16-25" tabindex="-1"></a>  <span class="fu">arrange</span>(site) <span class="sc">%&gt;%</span> </span>
<span id="cb16-26"><a href="usecase1.html#cb16-26" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>site)</span></code></pre></div>
<p>Finally, we’ll bundle this data up into a named list of matrices.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="usecase1.html#cb17-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb17-2"><a href="usecase1.html#cb17-2" tabindex="-1"></a>  <span class="at">qPCR.N =</span> <span class="fu">as.matrix</span>(qPCR_N_wide),</span>
<span id="cb17-3"><a href="usecase1.html#cb17-3" tabindex="-1"></a>  <span class="at">qPCR.K =</span> <span class="fu">as.matrix</span>(qPCR_K_wide),</span>
<span id="cb17-4"><a href="usecase1.html#cb17-4" tabindex="-1"></a>  <span class="at">count =</span> <span class="fu">as.matrix</span>(count_wide)</span>
<span id="cb17-5"><a href="usecase1.html#cb17-5" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="fit-the-model" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Fit the model<a href="usecase1.html#fit-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we understand our data, let’s fit the joint model. The key arguments of this function include:</p>
<ol style="list-style-type: decimal">
<li>data: list of <code>qPCR.K</code>, <code>qPCR.N</code>, and <code>count</code> matrices</li>
<li>family: probability distribution used to model the seine count data. A poisson distribution is chosen here.</li>
<li>p10priors: Beta distribution parameters for the prior on the probability of false positive eDNA detection, <span class="math inline">\(p_{10}\)</span>. c(1,20) is the default specification. More on this later.</li>
<li>q: logical value indicating the presence of multiple traditional gear types. Here, we’re only using data from one traditional method.</li>
</ol>
<p>More parameters exist to further customize the MCMC sampling, but we’ll stick with the defaults.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="usecase1.html#cb18-1" tabindex="-1"></a><span class="co"># run the joint model </span></span>
<span id="cb18-2"><a href="usecase1.html#cb18-2" tabindex="-1"></a>goby.fit1 <span class="ot">&lt;-</span> <span class="fu">jointModel</span>(<span class="at">data =</span> gobyData, <span class="at">family =</span> <span class="st">&#39;poisson&#39;</span>, </span>
<span id="cb18-3"><a href="usecase1.html#cb18-3" tabindex="-1"></a>                        <span class="at">p10priors =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="at">q=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><code>goby.fit1</code> is a list containing:</p>
<ol style="list-style-type: decimal">
<li>model fit (<code>goby.fit1$model</code>) of the class ‘stanfit’ and can be accessed and interpreted using all functions in the <a href="https://mc-stan.org/rstan/">rstan</a> package.</li>
<li>initial values used for each chain in MCMC (<code>goby.fit1$inits</code>)</li>
</ol>
</div>
<div id="model-selection" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Model selection<a href="usecase1.html#model-selection" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We previously made a choice to use a poisson distribution to describe the count data. This distribution assumes that the mean equals variance for count data at each site. Perhaps we want to test how that model specification compares to a model specification using a negative binomial distribution, which allows the variance of the count data to be greater than the mean.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="usecase1.html#cb19-1" tabindex="-1"></a><span class="co"># fit a new model with negative binomial distribution</span></span>
<span id="cb19-2"><a href="usecase1.html#cb19-2" tabindex="-1"></a>goby.fit2 <span class="ot">&lt;-</span> <span class="fu">jointModel</span>(<span class="at">data =</span> gobyData, <span class="at">family =</span> <span class="st">&#39;negbin&#39;</span>, </span>
<span id="cb19-3"><a href="usecase1.html#cb19-3" tabindex="-1"></a>                        <span class="at">p10priors =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="at">q=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>We can now compare the fit of these model to our data using the <code>jointSelect()</code> function, which performs leave-one-out cross validation with functions from the <code>loo</code> package.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="usecase1.html#cb20-1" tabindex="-1"></a><span class="co"># perform model selection</span></span>
<span id="cb20-2"><a href="usecase1.html#cb20-2" tabindex="-1"></a><span class="fu">jointSelect</span>(<span class="at">modelfits =</span> <span class="fu">list</span>(goby.fit1<span class="sc">$</span>model, goby.fit2<span class="sc">$</span>model))</span></code></pre></div>
<pre><code>##        elpd_diff se_diff
## model2     0.0       0.0
## model1 -2339.4     619.9</code></pre>
<p>These results tell us that model1 has a higher Bayesian LOO estimate of the expected log pointwise predictive density (<a href="https://mc-stan.org/loo/reference/loo-glossary.html">elpd_loo</a>). This means that <code>goby.fit1</code> is likely a better fit to the data.</p>
</div>
<div id="interpret-the-output" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Interpret the output<a href="usecase1.html#interpret-the-output" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="summarize-posterior-distributions" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Summarize posterior distributions<a href="usecase1.html#summarize-posterior-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s interpret <code>goby.fit1</code>. Use <code>jointSummarize()</code> to see the posterior summaries of the model parameters.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="usecase1.html#cb22-1" tabindex="-1"></a><span class="fu">jointSummarize</span>(goby.fit1<span class="sc">$</span>model, <span class="at">par =</span> <span class="fu">c</span>(<span class="st">&#39;p10&#39;</span>,<span class="st">&#39;beta&#39;</span>))</span></code></pre></div>
<pre><code>##       mean se_mean    sd  2.5% 97.5%    n_eff Rhat
## p10  0.002   0.000 0.001 0.001 0.003 16629.35    1
## beta 0.657   0.001 0.094 0.472 0.842 12362.86    1</code></pre>
<p>This summarizes the mean, sd, and quantiles of the posterior estimates of <span class="math inline">\(p_{10}\)</span> and <span class="math inline">\(\beta\)</span>, as well as the effective sample size (n_eff) and Rhat for the parameters.</p>
<p>The mean estimated probability of a false positive eDNA detection is 0.001. <span class="math inline">\(\beta\)</span> is the parameter that scales the sensitivity between eDNA and traditional sampling.</p>
<p>We can also use functions from the <code>bayesplot</code> package to examine the posterior distributions and chain convergence.</p>
<p>First let’s look at the posterior distribution for <span class="math inline">\(p_{10}\)</span>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="usecase1.html#cb24-1" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb24-2"><a href="usecase1.html#cb24-2" tabindex="-1"></a><span class="co"># plot posterior distribution, highlighting median and 80% credibility interval</span></span>
<span id="cb24-3"><a href="usecase1.html#cb24-3" tabindex="-1"></a><span class="fu">mcmc_areas</span>(<span class="fu">as.matrix</span>(goby.fit1<span class="sc">$</span>model), <span class="at">pars =</span> <span class="st">&#39;p10&#39;</span>, <span class="at">prob =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Next let’s look at chain convergence for <span class="math inline">\(p_{10}\)</span> and <span class="math inline">\(\mu_{i=1}\)</span>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="usecase1.html#cb25-1" tabindex="-1"></a><span class="co"># this will plot the MCMC chains for p10 and mu at site 1</span></span>
<span id="cb25-2"><a href="usecase1.html#cb25-2" tabindex="-1"></a><span class="fu">mcmc_trace</span>(rstan<span class="sc">::</span><span class="fu">extract</span>(goby.fit1<span class="sc">$</span>model, <span class="at">permuted =</span> <span class="cn">FALSE</span>), </span>
<span id="cb25-3"><a href="usecase1.html#cb25-3" tabindex="-1"></a>           <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&#39;p10&#39;</span>, <span class="st">&#39;mu[1]&#39;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="effort-necessary-to-detect-presence" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Effort necessary to detect presence<a href="usecase1.html#effort-necessary-to-detect-presence" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To further highlight the relative sensitivity of eDNA and traditional sampling, we can use <code>detectionCalculate()</code> to find the units of survey effort necessary to detect presence of the species. Here, detecting presence refers to producing at least one true positive eDNA detection or catching at least one individual in a traditional survey.</p>
<p>This function is finding the median number of survey units necessary to detect species presence if the expected catch rate, <span class="math inline">\(\mu\)</span> is 0.1, 0.5, or 1.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="usecase1.html#cb26-1" tabindex="-1"></a><span class="fu">detectionCalculate</span>(goby.fit1<span class="sc">$</span>model, <span class="at">mu=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), <span class="at">probability =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>##       mu n_traditional n_eDNA
## [1,] 0.1            24     16
## [2,] 0.5             5      4
## [3,] 1.0             3      2</code></pre>
<p>We can also plot these comparisons. <code>mu.min</code> and <code>mu.max</code> define the x-axis in the plot.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="usecase1.html#cb28-1" tabindex="-1"></a><span class="fu">detectionPlot</span>(goby.fit1<span class="sc">$</span>model, <span class="at">mu.min=</span><span class="fl">0.1</span>, <span class="at">mu.max =</span><span class="dv">1</span>, <span class="at">probability =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
</div>
<div id="calculate-mu_critical" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Calculate <span class="math inline">\(\mu_{critical}\)</span><a href="usecase1.html#calculate-mu_critical" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The probability of a true positive eDNA detection, <span class="math inline">\(p_{11}\)</span>, is a function of the expected catch rate, <span class="math inline">\(\mu\)</span>. Low values of <span class="math inline">\(\mu\)</span> correspond to low probability of eDNA detection. Since the probability of a false-positive eDNA detection is non-zero, the probability of a false positive detection may be higher than the probability of a true positive detection at very low values of <span class="math inline">\(\mu\)</span>.</p>
<p><span class="math inline">\(\mu_{critical}\)</span> describes the value of <span class="math inline">\(\mu\)</span> where the probability of a false positive eDNA detection equals the probability of a true positive eDNA detection. This value can be calculated using <code>muCritical()</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="usecase1.html#cb29-1" tabindex="-1"></a><span class="fu">muCritical</span>(goby.fit1<span class="sc">$</span>model, <span class="at">ci =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>## $median
## [1] 0.002958105
## 
## $lower_ci
## Highest Density Interval: 1.13e-03
## 
## $upper_ci
## Highest Density Interval: 5.19e-03</code></pre>
<p>This function calculates <span class="math inline">\(\mu_{critical}\)</span> using the entire posterior distributions of parameters from the model, and ‘HDI’ corresponds to the 90% credibility interval calculated using the highest density interval.</p>
</div>
</div>
<div id="prior-sensitivity-analysis" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Prior sensitivity analysis<a href="usecase1.html#prior-sensitivity-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The previous model implementation used default values for the beta prior distribution for <span class="math inline">\(p_{10}\)</span>. The choice of these prior parameters can impose undue influence on the model’s inference. The best way to investigate this is to perform a prior sensitivity analysis.</p>
<p>Let’s look at how three prior choices affect the posterior estimates of <span class="math inline">\(p_{10}\)</span> and <span class="math inline">\(\beta\)</span>.</p>
<p>Prior choice 1: default prior parameters c(1,20). The mean and sd of this prior distribution are 0.048 and 0.045, respectively.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="usecase1.html#cb31-1" tabindex="-1"></a>fit.prior<span class="fl">.1</span> <span class="ot">&lt;-</span> goby.fit1<span class="sc">$</span>model</span>
<span id="cb31-2"><a href="usecase1.html#cb31-2" tabindex="-1"></a><span class="fu">jointSummarize</span>(fit.prior<span class="fl">.1</span>, <span class="at">par =</span> <span class="fu">c</span>(<span class="st">&#39;p10&#39;</span>,<span class="st">&#39;beta&#39;</span>))</span></code></pre></div>
<pre><code>##       mean se_mean    sd  2.5% 97.5%    n_eff Rhat
## p10  0.002   0.000 0.001 0.001 0.003 16629.35    1
## beta 0.657   0.001 0.094 0.472 0.842 12362.86    1</code></pre>
<p>Prior choice 2: c(1,15). The mean and sd of this prior distribution are 0.063 and 0.058, respectively.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="usecase1.html#cb33-1" tabindex="-1"></a>fit.prior<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">jointModel</span>(<span class="at">data =</span> gobyData, <span class="at">family =</span> <span class="st">&#39;poisson&#39;</span>, </span>
<span id="cb33-2"><a href="usecase1.html#cb33-2" tabindex="-1"></a>                          <span class="at">p10priors =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">15</span>), <span class="at">q=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="usecase1.html#cb34-1" tabindex="-1"></a><span class="fu">jointSummarize</span>(fit.prior<span class="fl">.2</span><span class="sc">$</span>model, <span class="at">par =</span> <span class="fu">c</span>(<span class="st">&#39;p10&#39;</span>,<span class="st">&#39;beta&#39;</span>))</span></code></pre></div>
<pre><code>##       mean se_mean    sd  2.5% 97.5%    n_eff Rhat
## p10  0.002   0.000 0.001 0.001 0.003 18783.13    1
## beta 0.661   0.001 0.095 0.476 0.845 10833.95    1</code></pre>
<p>Prior choice 3: c(1,10). The mean and sd of this prior distribution are 0.091 and 0.083, respectively.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="usecase1.html#cb36-1" tabindex="-1"></a>fit.prior<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">jointModel</span>(<span class="at">data =</span> gobyData, <span class="at">family =</span> <span class="st">&#39;poisson&#39;</span>, </span>
<span id="cb36-2"><a href="usecase1.html#cb36-2" tabindex="-1"></a>                          <span class="at">p10priors =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="at">q=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="usecase1.html#cb37-1" tabindex="-1"></a><span class="fu">jointSummarize</span>(fit.prior<span class="fl">.3</span><span class="sc">$</span>model, <span class="at">par =</span> <span class="fu">c</span>(<span class="st">&#39;p10&#39;</span>,<span class="st">&#39;beta&#39;</span>))</span></code></pre></div>
<pre><code>##       mean se_mean    sd  2.5% 97.5%    n_eff Rhat
## p10  0.002   0.000 0.001 0.001 0.004 16410.58    1
## beta 0.669   0.001 0.094 0.487 0.854 10486.92    1</code></pre>
<p>You can see that the choice of the <span class="math inline">\(p_{10}\)</span> prior within this range has little influence on the estimated parameters.</p>
</div>
<div id="initialvalues1" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Initial values<a href="usecase1.html#initialvalues1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By default, <code>eDNAjoint</code> will provide initial values for parameters estimated by the model, but you can provide your own initial values if you prefer. Here is an example of providing initial values for parameters, <code>mu</code>,<code>p10</code>, and <code>beta</code>, as an input in <code>jointModel()</code>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="usecase1.html#cb39-1" tabindex="-1"></a><span class="co"># set number of chains</span></span>
<span id="cb39-2"><a href="usecase1.html#cb39-2" tabindex="-1"></a>n.chain <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb39-3"><a href="usecase1.html#cb39-3" tabindex="-1"></a></span>
<span id="cb39-4"><a href="usecase1.html#cb39-4" tabindex="-1"></a><span class="co"># initial values should be a list of named lists</span></span>
<span id="cb39-5"><a href="usecase1.html#cb39-5" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb39-6"><a href="usecase1.html#cb39-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.chain){</span>
<span id="cb39-7"><a href="usecase1.html#cb39-7" tabindex="-1"></a>  inits[[i]] <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb39-8"><a href="usecase1.html#cb39-8" tabindex="-1"></a>    <span class="co"># length should equal the number of sites (dim(gobyData$count)[1]) for each chain</span></span>
<span id="cb39-9"><a href="usecase1.html#cb39-9" tabindex="-1"></a>    <span class="at">mu =</span> stats<span class="sc">::</span><span class="fu">runif</span>(<span class="fu">dim</span>(gobyData<span class="sc">$</span>count)[<span class="dv">1</span>], <span class="fl">0.01</span>, <span class="dv">5</span>), </span>
<span id="cb39-10"><a href="usecase1.html#cb39-10" tabindex="-1"></a>    <span class="co"># length should equal 1 for each chain </span></span>
<span id="cb39-11"><a href="usecase1.html#cb39-11" tabindex="-1"></a>    <span class="at">p10 =</span> stats<span class="sc">::</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.0001</span>,<span class="fl">0.08</span>),</span>
<span id="cb39-12"><a href="usecase1.html#cb39-12" tabindex="-1"></a>    <span class="co"># length should equal 1 for each chain </span></span>
<span id="cb39-13"><a href="usecase1.html#cb39-13" tabindex="-1"></a>    <span class="at">beta =</span> stats<span class="sc">::</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.05</span>,<span class="fl">0.2</span>)</span>
<span id="cb39-14"><a href="usecase1.html#cb39-14" tabindex="-1"></a>    )</span>
<span id="cb39-15"><a href="usecase1.html#cb39-15" tabindex="-1"></a>}</span>
<span id="cb39-16"><a href="usecase1.html#cb39-16" tabindex="-1"></a></span>
<span id="cb39-17"><a href="usecase1.html#cb39-17" tabindex="-1"></a><span class="co"># now fit the model</span></span>
<span id="cb39-18"><a href="usecase1.html#cb39-18" tabindex="-1"></a>fit.w.inits <span class="ot">&lt;-</span> <span class="fu">jointModel</span>(<span class="at">data =</span> gobyData, <span class="at">initial_values =</span> inits)</span></code></pre></div>
<pre><code>## 
## SAMPLING FOR MODEL &#39;joint_binary_pois&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 0.000175 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 1.75 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:    1 / 3000 [  0%]  (Warmup)
## Chain 1: Iteration:  500 / 3000 [ 16%]  (Warmup)
## Chain 1: Iteration:  501 / 3000 [ 16%]  (Sampling)
## Chain 1: Iteration: 1000 / 3000 [ 33%]  (Sampling)
## Chain 1: Iteration: 1500 / 3000 [ 50%]  (Sampling)
## Chain 1: Iteration: 2000 / 3000 [ 66%]  (Sampling)
## Chain 1: Iteration: 2500 / 3000 [ 83%]  (Sampling)
## Chain 1: Iteration: 3000 / 3000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 1.941 seconds (Warm-up)
## Chain 1:                4.359 seconds (Sampling)
## Chain 1:                6.3 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;joint_binary_pois&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 0.000165 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 1.65 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:    1 / 3000 [  0%]  (Warmup)
## Chain 2: Iteration:  500 / 3000 [ 16%]  (Warmup)
## Chain 2: Iteration:  501 / 3000 [ 16%]  (Sampling)
## Chain 2: Iteration: 1000 / 3000 [ 33%]  (Sampling)
## Chain 2: Iteration: 1500 / 3000 [ 50%]  (Sampling)
## Chain 2: Iteration: 2000 / 3000 [ 66%]  (Sampling)
## Chain 2: Iteration: 2500 / 3000 [ 83%]  (Sampling)
## Chain 2: Iteration: 3000 / 3000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 1.904 seconds (Warm-up)
## Chain 2:                4.786 seconds (Sampling)
## Chain 2:                6.69 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;joint_binary_pois&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 8.1e-05 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.81 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:    1 / 3000 [  0%]  (Warmup)
## Chain 3: Iteration:  500 / 3000 [ 16%]  (Warmup)
## Chain 3: Iteration:  501 / 3000 [ 16%]  (Sampling)
## Chain 3: Iteration: 1000 / 3000 [ 33%]  (Sampling)
## Chain 3: Iteration: 1500 / 3000 [ 50%]  (Sampling)
## Chain 3: Iteration: 2000 / 3000 [ 66%]  (Sampling)
## Chain 3: Iteration: 2500 / 3000 [ 83%]  (Sampling)
## Chain 3: Iteration: 3000 / 3000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 2.29 seconds (Warm-up)
## Chain 3:                4.291 seconds (Sampling)
## Chain 3:                6.581 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;joint_binary_pois&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 8.8e-05 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.88 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:    1 / 3000 [  0%]  (Warmup)
## Chain 4: Iteration:  500 / 3000 [ 16%]  (Warmup)
## Chain 4: Iteration:  501 / 3000 [ 16%]  (Sampling)
## Chain 4: Iteration: 1000 / 3000 [ 33%]  (Sampling)
## Chain 4: Iteration: 1500 / 3000 [ 50%]  (Sampling)
## Chain 4: Iteration: 2000 / 3000 [ 66%]  (Sampling)
## Chain 4: Iteration: 2500 / 3000 [ 83%]  (Sampling)
## Chain 4: Iteration: 3000 / 3000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 1.923 seconds (Warm-up)
## Chain 4:                4.338 seconds (Sampling)
## Chain 4:                6.261 seconds (Total)
## Chain 4: 
## Refer to the eDNAjoint guide for visualization tips:  https://bookdown.org/abigailkeller/eDNAjoint_vignette/tips.html#visualization-tips</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="usecase1.html#cb41-1" tabindex="-1"></a><span class="co"># check to see the initial values that were used</span></span>
<span id="cb41-2"><a href="usecase1.html#cb41-2" tabindex="-1"></a>fit.w.inits<span class="sc">$</span>inits</span></code></pre></div>
<pre><code>## $chain1
## $chain1$mu_trad
##  [1] 2.01391381 1.25559601 0.41563428 4.82694638 0.83600351 4.30748495 2.36601809
##  [8] 0.39530283 1.45825815 2.66141690 3.32957309 3.60864127 2.34038247 4.92368838
## [15] 2.11719136 0.91069842 2.67780586 3.86534942 4.80623740 2.17228961 4.20042273
## [22] 3.34444017 2.28607129 0.15141236 0.68654561 3.06456579 4.73994272 3.70362987
## [29] 3.99786725 2.04876099 2.93804214 0.91720229 0.58064812 3.33776691 2.98863764
## [36] 2.55980605 0.06658861 4.39519622 4.67691937
## 
## $chain1$mu
##  [1] 2.01391381 1.25559601 0.41563428 4.82694638 0.83600351 4.30748495 2.36601809
##  [8] 0.39530283 1.45825815 2.66141690 3.32957309 3.60864127 2.34038247 4.92368838
## [15] 2.11719136 0.91069842 2.67780586 3.86534942 4.80623740 2.17228961 4.20042273
## [22] 3.34444017 2.28607129 0.15141236 0.68654561 3.06456579 4.73994272 3.70362987
## [29] 3.99786725 2.04876099 2.93804214 0.91720229 0.58064812 3.33776691 2.98863764
## [36] 2.55980605 0.06658861 4.39519622 4.67691937
## 
## $chain1$log_p10
## [1] -2.999918
## 
## $chain1$beta
## [1] 0.05397204
## 
## 
## $chain2
## $chain2$mu_trad
##  [1] 0.9654809 2.2014818 0.9671374 3.1678988 4.5603247 1.8170409 4.5563945 3.9641428
##  [9] 4.8218774 3.0925700 1.9031798 1.6237121 1.3969457 3.9350216 1.8576002 4.2436057
## [17] 3.2635289 2.5389627 1.2403107 3.2642428 0.6320112 4.7961765 2.1780876 4.3163066
## [25] 3.9847331 4.2370985 0.1399096 1.2657270 1.8978087 2.0389883 4.1236273 3.9105557
## [33] 4.9132148 3.5091323 2.6031631 4.3297012 3.6721368 3.3247593 0.4818758
## 
## $chain2$mu
##  [1] 0.9654809 2.2014818 0.9671374 3.1678988 4.5603247 1.8170409 4.5563945 3.9641428
##  [9] 4.8218774 3.0925700 1.9031798 1.6237121 1.3969457 3.9350216 1.8576002 4.2436057
## [17] 3.2635289 2.5389627 1.2403107 3.2642428 0.6320112 4.7961765 2.1780876 4.3163066
## [25] 3.9847331 4.2370985 0.1399096 1.2657270 1.8978087 2.0389883 4.1236273 3.9105557
## [33] 4.9132148 3.5091323 2.6031631 4.3297012 3.6721368 3.3247593 0.4818758
## 
## $chain2$log_p10
## [1] -2.655146
## 
## $chain2$beta
## [1] 0.111839
## 
## 
## $chain3
## $chain3$mu_trad
##  [1] 0.9165691 2.6670734 2.2691038 3.8368410 0.8432949 4.3849986 0.4118777 1.0452265
##  [9] 1.7920187 3.8483753 2.4016282 4.1951907 1.7224685 3.0833681 0.9852619 1.8655148
## [17] 3.9343529 4.5467676 2.7610491 4.3980515 3.5321668 2.7537674 0.8118323 1.6419269
## [25] 2.2440976 4.0824542 2.9571905 1.3469608 3.3006075 0.5168841 1.1707444 4.2831916
## [33] 3.6723485 3.8128558 4.2430229 2.7496592 2.9975857 4.9951764 2.2973047
## 
## $chain3$mu
##  [1] 0.9165691 2.6670734 2.2691038 3.8368410 0.8432949 4.3849986 0.4118777 1.0452265
##  [9] 1.7920187 3.8483753 2.4016282 4.1951907 1.7224685 3.0833681 0.9852619 1.8655148
## [17] 3.9343529 4.5467676 2.7610491 4.3980515 3.5321668 2.7537674 0.8118323 1.6419269
## [25] 2.2440976 4.0824542 2.9571905 1.3469608 3.3006075 0.5168841 1.1707444 4.2831916
## [33] 3.6723485 3.8128558 4.2430229 2.7496592 2.9975857 4.9951764 2.2973047
## 
## $chain3$log_p10
## [1] -2.824668
## 
## $chain3$beta
## [1] 0.05075341
## 
## 
## $chain4
## $chain4$mu_trad
##  [1] 0.2139959 3.8336850 2.2284548 3.8006431 3.7800381 0.3500877 2.7647242 1.7389432
##  [9] 3.1052340 0.1519294 0.2122061 2.3662545 4.9653820 0.8232471 3.7508484 4.2358386
## [17] 1.8070711 1.4005192 4.5797479 1.3575003 2.6236618 1.8111736 3.9053329 1.1063771
## [25] 1.4386567 2.5149701 2.0564225 4.8987182 4.3265848 1.8907922 2.6205461 2.8983300
## [33] 2.5966957 2.2764267 0.9491063 2.6725291 4.7969291 2.1751389 0.9637220
## 
## $chain4$mu
##  [1] 0.2139959 3.8336850 2.2284548 3.8006431 3.7800381 0.3500877 2.7647242 1.7389432
##  [9] 3.1052340 0.1519294 0.2122061 2.3662545 4.9653820 0.8232471 3.7508484 4.2358386
## [17] 1.8070711 1.4005192 4.5797479 1.3575003 2.6236618 1.8111736 3.9053329 1.1063771
## [25] 1.4386567 2.5149701 2.0564225 4.8987182 4.3265848 1.8907922 2.6205461 2.8983300
## [33] 2.5966957 2.2764267 0.9491063 2.6725291 4.7969291 2.1751389 0.9637220
## 
## $chain4$log_p10
## [1] -2.869797
## 
## $chain4$beta
## [1] 0.07853136</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="installation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="usecase2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
