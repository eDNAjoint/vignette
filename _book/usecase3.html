<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Use case 3: jointModel() with multiple traditional gear types | eDNAjoint: an R package for interpreting paired or semi-paired environmental DNA and traditional survey data in a Bayesian framework</title>
  <meta name="description" content="Chapter 5 Use case 3: jointModel() with multiple traditional gear types | eDNAjoint: an R package for interpreting paired or semi-paired environmental DNA and traditional survey data in a Bayesian framework" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Use case 3: jointModel() with multiple traditional gear types | eDNAjoint: an R package for interpreting paired or semi-paired environmental DNA and traditional survey data in a Bayesian framework" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://bookdown.org/abigailkeller/eDNAjoint/images/eDNAjoint_logo.png" />
  
  <meta name="github-repo" content="abigailkeller/eDNAjoint" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Use case 3: jointModel() with multiple traditional gear types | eDNAjoint: an R package for interpreting paired or semi-paired environmental DNA and traditional survey data in a Bayesian framework" />
  
  
  <meta name="twitter:image" content="https://bookdown.org/abigailkeller/eDNAjoint/images/eDNAjoint_logo.png" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="usecase2.html"/>
<link rel="next" href="usecase4.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">eDNAjoint</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a></li>
<li class="chapter" data-level="3" data-path="usecase1.html"><a href="usecase1.html"><i class="fa fa-check"></i><b>3</b> Use case 1: basic use of <code>jointModel()</code></a>
<ul>
<li class="chapter" data-level="3.1" data-path="usecase1.html"><a href="usecase1.html#prepare-the-data"><i class="fa fa-check"></i><b>3.1</b> Prepare the data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="usecase1.html"><a href="usecase1.html#longtowide"><i class="fa fa-check"></i><b>3.1.1</b> Converting data from long to wide</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="usecase1.html"><a href="usecase1.html#fit-the-model"><i class="fa fa-check"></i><b>3.2</b> Fit the model</a></li>
<li class="chapter" data-level="3.3" data-path="usecase1.html"><a href="usecase1.html#model-selection"><i class="fa fa-check"></i><b>3.3</b> Model selection</a></li>
<li class="chapter" data-level="3.4" data-path="usecase1.html"><a href="usecase1.html#interpret-the-output"><i class="fa fa-check"></i><b>3.4</b> Interpret the output</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="usecase1.html"><a href="usecase1.html#summarize-posterior-distributions"><i class="fa fa-check"></i><b>3.4.1</b> Summarize posterior distributions</a></li>
<li class="chapter" data-level="3.4.2" data-path="usecase1.html"><a href="usecase1.html#effort-necessary-to-detect-presence"><i class="fa fa-check"></i><b>3.4.2</b> Effort necessary to detect presence</a></li>
<li class="chapter" data-level="3.4.3" data-path="usecase1.html"><a href="usecase1.html#calculate-mu_critical"><i class="fa fa-check"></i><b>3.4.3</b> Calculate <span class="math inline">\(\mu_{critical}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="usecase1.html"><a href="usecase1.html#prior-sensitivity-analysis"><i class="fa fa-check"></i><b>3.5</b> Prior sensitivity analysis</a></li>
<li class="chapter" data-level="3.6" data-path="usecase1.html"><a href="usecase1.html#initialvalues1"><i class="fa fa-check"></i><b>3.6</b> Initial values</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="usecase2.html"><a href="usecase2.html"><i class="fa fa-check"></i><b>4</b> Use case 2: <code>jointModel()</code> with site-level covariates</a>
<ul>
<li class="chapter" data-level="4.1" data-path="usecase2.html"><a href="usecase2.html#fit-the-model-1"><i class="fa fa-check"></i><b>4.1</b> Fit the model</a></li>
<li class="chapter" data-level="4.2" data-path="usecase2.html"><a href="usecase2.html#model-selection-1"><i class="fa fa-check"></i><b>4.2</b> Model selection</a></li>
<li class="chapter" data-level="4.3" data-path="usecase2.html"><a href="usecase2.html#interpret-the-output-1"><i class="fa fa-check"></i><b>4.3</b> Interpret the output</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="usecase2.html"><a href="usecase2.html#summarize-posterior-distributions-1"><i class="fa fa-check"></i><b>4.3.1</b> Summarize posterior distributions</a></li>
<li class="chapter" data-level="4.3.2" data-path="usecase2.html"><a href="usecase2.html#effort-necessary-to-detect-presence-1"><i class="fa fa-check"></i><b>4.3.2</b> Effort necessary to detect presence</a></li>
<li class="chapter" data-level="4.3.3" data-path="usecase2.html"><a href="usecase2.html#calculate-mu_critical-1"><i class="fa fa-check"></i><b>4.3.3</b> Calculate <span class="math inline">\(\mu_{critical}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="usecase2.html"><a href="usecase2.html#initialvalues2"><i class="fa fa-check"></i><b>4.4</b> Initial values</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="usecase3.html"><a href="usecase3.html"><i class="fa fa-check"></i><b>5</b> Use case 3: <code>jointModel()</code> with multiple traditional gear types</a>
<ul>
<li class="chapter" data-level="5.1" data-path="usecase3.html"><a href="usecase3.html#prepare-the-data-1"><i class="fa fa-check"></i><b>5.1</b> Prepare the data</a></li>
<li class="chapter" data-level="5.2" data-path="usecase3.html"><a href="usecase3.html#fit-the-model-2"><i class="fa fa-check"></i><b>5.2</b> Fit the model</a></li>
<li class="chapter" data-level="5.3" data-path="usecase3.html"><a href="usecase3.html#model-selection-2"><i class="fa fa-check"></i><b>5.3</b> Model selection</a></li>
<li class="chapter" data-level="5.4" data-path="usecase3.html"><a href="usecase3.html#interpret-the-output-2"><i class="fa fa-check"></i><b>5.4</b> Interpret the output</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="usecase3.html"><a href="usecase3.html#summarize-posterior-distributions-2"><i class="fa fa-check"></i><b>5.4.1</b> Summarize posterior distributions</a></li>
<li class="chapter" data-level="5.4.2" data-path="usecase3.html"><a href="usecase3.html#effort-necessary-to-detect-presence-2"><i class="fa fa-check"></i><b>5.4.2</b> Effort necessary to detect presence</a></li>
<li class="chapter" data-level="5.4.3" data-path="usecase3.html"><a href="usecase3.html#calculate-mu_critical-2"><i class="fa fa-check"></i><b>5.4.3</b> Calculate <span class="math inline">\(\mu_{critical}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="usecase3.html"><a href="usecase3.html#traditionalmodel"><i class="fa fa-check"></i><b>5.5</b> traditionalModel()</a></li>
<li class="chapter" data-level="5.6" data-path="usecase3.html"><a href="usecase3.html#initialvalues3"><i class="fa fa-check"></i><b>5.6</b> Initial values</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="usecase4.html"><a href="usecase4.html"><i class="fa fa-check"></i><b>6</b> Use case 4: <code>jointModel()</code> with semi-paired data</a>
<ul>
<li class="chapter" data-level="6.1" data-path="usecase4.html"><a href="usecase4.html#simulate-semi-paired-data"><i class="fa fa-check"></i><b>6.1</b> Simulate semi-paired data</a></li>
<li class="chapter" data-level="6.2" data-path="usecase4.html"><a href="usecase4.html#prepare-the-data-2"><i class="fa fa-check"></i><b>6.2</b> Prepare the data</a></li>
<li class="chapter" data-level="6.3" data-path="usecase4.html"><a href="usecase4.html#fit-the-model-3"><i class="fa fa-check"></i><b>6.3</b> Fit the model</a></li>
<li class="chapter" data-level="6.4" data-path="usecase4.html"><a href="usecase4.html#interpret-the-output-3"><i class="fa fa-check"></i><b>6.4</b> Interpret the output</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="usecase4.html"><a href="usecase4.html#summarize-posterior-distributions-3"><i class="fa fa-check"></i><b>6.4.1</b> Summarize posterior distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="usecase4.html"><a href="usecase4.html#initialvalues4"><i class="fa fa-check"></i><b>6.5</b> Initial values</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="model.html"><a href="model.html"><i class="fa fa-check"></i><b>7</b> The model</a>
<ul>
<li class="chapter" data-level="7.1" data-path="model.html"><a href="model.html#modeldescription"><i class="fa fa-check"></i><b>7.1</b> Model description</a></li>
<li class="chapter" data-level="7.2" data-path="model.html"><a href="model.html#bayesian-modeling-stan"><i class="fa fa-check"></i><b>7.2</b> Bayesian modeling: Stan</a></li>
<li class="chapter" data-level="7.3" data-path="model.html"><a href="model.html#priors"><i class="fa fa-check"></i><b>7.3</b> Priors</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tips.html"><a href="tips.html"><i class="fa fa-check"></i><b>8</b> Tips</a>
<ul>
<li class="chapter" data-level="8.1" data-path="tips.html"><a href="tips.html#visualization-tips"><i class="fa fa-check"></i><b>8.1</b> Visualization tips</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="tips.html"><a href="tips.html#posterior-samples"><i class="fa fa-check"></i><b>8.1.1</b> Posterior samples</a></li>
<li class="chapter" data-level="8.1.2" data-path="tips.html"><a href="tips.html#chain-convergence"><i class="fa fa-check"></i><b>8.1.2</b> Chain convergence</a></li>
<li class="chapter" data-level="8.1.3" data-path="tips.html"><a href="tips.html#shinystan"><i class="fa fa-check"></i><b>8.1.3</b> Shinystan</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="tips.html"><a href="tips.html#troubleshooting-tips"><i class="fa fa-check"></i><b>8.2</b> Troubleshooting tips</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="tips.html"><a href="tips.html#quick-tips"><i class="fa fa-check"></i><b>8.2.1</b> Quick tips</a></li>
<li class="chapter" data-level="8.2.2" data-path="tips.html"><a href="tips.html#initial-values"><i class="fa fa-check"></i><b>8.2.2</b> Initial values</a></li>
<li class="chapter" data-level="8.2.3" data-path="tips.html"><a href="tips.html#changing-priors"><i class="fa fa-check"></i><b>8.2.3</b> Changing priors</a></li>
<li class="chapter" data-level="8.2.4" data-path="tips.html"><a href="tips.html#adding-site-level-covariates"><i class="fa fa-check"></i><b>8.2.4</b> Adding site-level covariates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="citation.html"><a href="citation.html"><i class="fa fa-check"></i><b>9</b> Citation</a></li>
<li class="chapter" data-level="10" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>10</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">eDNAjoint: an R package for interpreting paired or semi-paired environmental DNA and traditional survey data in a Bayesian framework</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="usecase3" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Use case 3: <code>jointModel()</code> with multiple traditional gear types<a href="usecase3.html#usecase3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This third use case will show how to fit and interpret the joint model with paired eDNA and traditional survey data when multiple traditional gear types have been used. These different gear types may have different expected catch rates, <span class="math inline">\(\mu\)</span>, represented by gear-specific scaling coefficients <em>q</em>.</p>
<p><br></p>
<p><img src="images/basic_diagram_catchability_final-01.png" width="50%" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>The data used in this example comes from a study by Keller et al. (2022) about invasive European green crab (<em>Carcinus maenas</em>) in Washington state. Environmental DNA samples were collected at 20 sites, along with paired baited trap sampling. The eDNA data is detection/non-detection data generated through quantitative polymerase chain reaction (qPCR).</p>
<div id="prepare-the-data-1" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Prepare the data<a href="usecase3.html#prepare-the-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Similar to the goby data, the green crab data is still a list of matrices. Now, instead of data on site-level covariates, <code>site.cov</code>, there is data representing the gear type for each of the traditional samples, <code>count.type</code>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="usecase3.html#cb67-1" tabindex="-1"></a><span class="fu">library</span>(eDNAjoint)</span>
<span id="cb67-2"><a href="usecase3.html#cb67-2" tabindex="-1"></a><span class="fu">data</span>(greencrabData)</span>
<span id="cb67-3"><a href="usecase3.html#cb67-3" tabindex="-1"></a><span class="fu">names</span>(greencrabData)</span></code></pre></div>
<pre><code>## [1] &quot;qPCR.N&quot;     &quot;qPCR.K&quot;     &quot;count&quot;      &quot;count.type&quot;</code></pre>
<p>Again, all matrices should have the same number of rows (n=20), and rows across all four matrices should correspond to the same sites.</p>
<p>Let’s look at the <code>count</code>. This data is from baited trap sampling for green crab. Each integer refers to the catch of each trap (i.e., catch per unit effort, when effort = 1). The rows correspond to sites, and the columns refer to the replicated trap samples (secondary sample units) at each site, with a maximum of 420 samples.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="usecase3.html#cb69-1" tabindex="-1"></a><span class="fu">dim</span>(greencrabData<span class="sc">$</span>count)</span></code></pre></div>
<pre><code>## [1]  20 420</code></pre>
<p>Blank spaces are filled with NA at sites where fewer trap samples were collected than the maximum. In this example, the count data are integers, but continuous values can be used in the model (see Eq. 1.3 in the model description).</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="usecase3.html#cb71-1" tabindex="-1"></a>greencrabData<span class="sc">$</span>count[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span></code></pre></div>
<pre><code>##      1 2 3 4 5 6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
## [1,] 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
## [2,] 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
## [3,] 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
## [4,] 1 0 1 2 0 0  0  0  0  0  0  0  0  0  0  2  0  0  0  1
## [5,] 0 0 0 0 0 0  0  0 NA NA NA NA NA NA NA NA NA NA NA NA
## [6,] 0 0 0 0 0 0 NA NA NA NA NA NA NA NA NA NA NA NA NA NA</code></pre>
<p>Next, let’s look at <code>count.type</code>, which consists of integer indicators of gear type for each trap sample. Here, 1 refers to the Fukui gear type, and 2 refers to the Minnow gear type.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="usecase3.html#cb73-1" tabindex="-1"></a>greencrabData<span class="sc">$</span>count.type[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span></code></pre></div>
<pre><code>##      1 2 3 4 5 6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
## [1,] 1 1 1 1 2 1  2  2  2  2  2  2  1  1  1  1  2  1  1  2
## [2,] 2 2 2 2 2 2  2  2  2  1  1  1  1  1  1  1  2  2  2  2
## [3,] 1 1 1 2 1 2  1  1  1  2  1  2  2  1  2  2  1  2  1  2
## [4,] 2 2 2 2 2 2  2  2  1  2  2  2  2  2  2  2  2  2  2  2
## [5,] 1 2 1 2 1 2  1  2 NA NA NA NA NA NA NA NA NA NA NA NA
## [6,] 2 1 2 1 2 1 NA NA NA NA NA NA NA NA NA NA NA NA NA NA</code></pre>
<p>Note that the locations of the NAs in this matrix match <code>count</code>.</p>
<p>For more data formatting guidance, see <a href="usecase1.html#longtowide">section 2.1.1</a>.</p>
</div>
<div id="fit-the-model-2" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Fit the model<a href="usecase3.html#fit-the-model-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we understand our data, let’s fit the joint model. The key arguments of this function include:</p>
<ol style="list-style-type: decimal">
<li>data: list of <code>qPCR.K</code>, <code>qPCR.N</code>, <code>count</code>, and <code>count.type</code> matrices</li>
<li>cov: no site-level covariates are included in this model</li>
<li>family: probability distribution used to model the trap count data. A negative binomial distribution is chosen here.</li>
<li>p10priors: Beta distribution parameters for the prior on the probability of false positive eDNA detection, <span class="math inline">\(p_{10}\)</span>. c(1,20) is the default specification.</li>
<li>q: logical value indicating the presence of multiple traditional gear types.</li>
</ol>
<p>More parameters exist to further customize the MCMC sampling, but we’ll stick with the defaults.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="usecase3.html#cb75-1" tabindex="-1"></a><span class="co"># run the joint model with gear scaling coefficients</span></span>
<span id="cb75-2"><a href="usecase3.html#cb75-2" tabindex="-1"></a>greencrab.fit.q.negbin <span class="ot">&lt;-</span> <span class="fu">jointModel</span>(<span class="at">data =</span> greencrabData, <span class="at">cov =</span> <span class="cn">NULL</span>, <span class="at">family =</span> <span class="st">&#39;negbin&#39;</span>, </span>
<span id="cb75-3"><a href="usecase3.html#cb75-3" tabindex="-1"></a>                                     <span class="at">p10priors =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="at">q =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="model-selection-2" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Model selection<a href="usecase3.html#model-selection-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We previously made a choice to model the green crab count data with a negative binomial distribution. Perhaps we want to test how that model specification compares to a model specification where count data is modeled with a poisson distribution.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="usecase3.html#cb76-1" tabindex="-1"></a><span class="co"># run the joint model with poisson distribution</span></span>
<span id="cb76-2"><a href="usecase3.html#cb76-2" tabindex="-1"></a>greencrab.fit.q.pois <span class="ot">&lt;-</span> <span class="fu">jointModel</span>(<span class="at">data =</span> greencrabData, <span class="at">cov=</span><span class="cn">NULL</span>, <span class="at">family =</span> <span class="st">&#39;poisson&#39;</span>, </span>
<span id="cb76-3"><a href="usecase3.html#cb76-3" tabindex="-1"></a>                                   <span class="at">p10priors =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="at">q=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Let’s also fit some models where we assume that both gear types have the same catchability. We set q=FALSE to not estimate gear scaling coefficients.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="usecase3.html#cb77-1" tabindex="-1"></a><span class="co"># run the joint model with four covariates</span></span>
<span id="cb77-2"><a href="usecase3.html#cb77-2" tabindex="-1"></a>greencrab.fit.negbin <span class="ot">&lt;-</span> <span class="fu">jointModel</span>(<span class="at">data =</span> greencrabData, <span class="at">cov=</span><span class="cn">NULL</span>, <span class="at">family =</span> <span class="st">&#39;negbin&#39;</span>, </span>
<span id="cb77-3"><a href="usecase3.html#cb77-3" tabindex="-1"></a>                                   <span class="at">p10priors =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="at">q=</span><span class="cn">FALSE</span>)</span>
<span id="cb77-4"><a href="usecase3.html#cb77-4" tabindex="-1"></a>greencrab.fit.pois <span class="ot">&lt;-</span> <span class="fu">jointModel</span>(<span class="at">data =</span> greencrabData, <span class="at">cov=</span><span class="cn">NULL</span>, <span class="at">family =</span> <span class="st">&#39;poisson&#39;</span>, </span>
<span id="cb77-5"><a href="usecase3.html#cb77-5" tabindex="-1"></a>                                 <span class="at">p10priors =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">20</span>), <span class="at">q=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p>Now let’s perform model selection using leave-one-out cross validation.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="usecase3.html#cb78-1" tabindex="-1"></a><span class="co"># perform model selection</span></span>
<span id="cb78-2"><a href="usecase3.html#cb78-2" tabindex="-1"></a><span class="fu">jointSelect</span>(<span class="at">modelfits =</span> <span class="fu">list</span>(</span>
<span id="cb78-3"><a href="usecase3.html#cb78-3" tabindex="-1"></a>  <span class="co"># include gear scaling coefficient, model count data with negative binomial</span></span>
<span id="cb78-4"><a href="usecase3.html#cb78-4" tabindex="-1"></a>  greencrab.fit.q.negbin<span class="sc">$</span>model, </span>
<span id="cb78-5"><a href="usecase3.html#cb78-5" tabindex="-1"></a>  <span class="co"># include gear scaling coefficient, model count data with poisson</span></span>
<span id="cb78-6"><a href="usecase3.html#cb78-6" tabindex="-1"></a>  greencrab.fit.q.pois<span class="sc">$</span>model, </span>
<span id="cb78-7"><a href="usecase3.html#cb78-7" tabindex="-1"></a>  <span class="co"># include gear scaling coefficient, model count data with negative binomial</span></span>
<span id="cb78-8"><a href="usecase3.html#cb78-8" tabindex="-1"></a>  greencrab.fit.negbin<span class="sc">$</span>model, </span>
<span id="cb78-9"><a href="usecase3.html#cb78-9" tabindex="-1"></a>  <span class="co"># include gear scaling coefficient, model count data with poisson</span></span>
<span id="cb78-10"><a href="usecase3.html#cb78-10" tabindex="-1"></a>  greencrab.fit.pois<span class="sc">$</span>model)) </span></code></pre></div>
<pre><code>##        elpd_diff se_diff
## model3    0.0       0.0 
## model1   -1.0       1.9 
## model4 -165.9      38.4 
## model2 -168.5      37.7</code></pre>
<p>These results tell us that models one and three (models with and without gear scaling coefficients for the gear types) that use a negative binomial distribution for count data have similar Bayesian LOO estimates of the expected log pointwise predictive density (elpd_loo). Notably, a negative binomial distribution represents the data-generating process for our count data much better than a poisson distribution.</p>
</div>
<div id="interpret-the-output-2" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Interpret the output<a href="usecase3.html#interpret-the-output-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="summarize-posterior-distributions-2" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Summarize posterior distributions<a href="usecase3.html#summarize-posterior-distributions-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the sake of illustration, let’s interpret the results of the model fit with gear scaling coefficients. Use <code>jointSummarize()</code> to see the posterior summaries of the model parameters.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="usecase3.html#cb80-1" tabindex="-1"></a><span class="fu">jointSummarize</span>(greencrab.fit.q.negbin<span class="sc">$</span>model, <span class="at">par =</span> <span class="fu">c</span>(<span class="st">&#39;p10&#39;</span>,<span class="st">&#39;beta&#39;</span>,<span class="st">&#39;q&#39;</span>))</span></code></pre></div>
<pre><code>##       mean se_mean    sd  2.5% 97.5%     n_eff Rhat
## p10  0.019   0.000 0.010 0.005 0.041 10842.124    1
## beta 1.265   0.003 0.245 0.800 1.767  8633.901    1
## q[1] 0.795   0.001 0.101 0.611 1.006  6699.013    1</code></pre>
<p>This summarizes the mean, sd, and quantiles of the posterior estimates of <span class="math inline">\(p_{10}\)</span>, <span class="math inline">\(\beta\)</span>, and <em>q</em>, as well as the effective sample size (n_eff) and Rhat for the parameters.</p>
<p>The mean estimated probability of a false positive eDNA detection is ~0.01. <code>beta</code> is the parameter that scales the sensitivity of eDNA sampling relative to trap sampling. <code>q[1]</code> represents the gear scaling coefficient of gear type 2, which scales the catch rate of gear type 2 relative to gear type 1.</p>
<p>Now let’s look at the summary of <code>mu</code>.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="usecase3.html#cb82-1" tabindex="-1"></a><span class="fu">jointSummarize</span>(greencrab.fit.q.negbin<span class="sc">$</span>model, <span class="at">par =</span> <span class="st">&#39;mu&#39;</span>)</span></code></pre></div>
<pre><code>##           mean se_mean    sd  2.5%  97.5%     n_eff Rhat
## mu[1,1]  0.107   0.000 0.028 0.060  0.169 12092.729    1
## mu[1,2]  0.084   0.000 0.023 0.047  0.136 13041.050    1
## mu[2,1]  0.032   0.000 0.034 0.001  0.124 13058.609    1
## mu[2,2]  0.026   0.000 0.027 0.001  0.098 13179.902    1
## mu[3,1]  0.017   0.000 0.017 0.000  0.063 12227.341    1
## mu[3,2]  0.014   0.000 0.014 0.000  0.051 12585.700    1
## mu[4,1]  0.678   0.001 0.105 0.497  0.912 10471.339    1
## mu[4,2]  0.535   0.001 0.090 0.380  0.730 12571.650    1
## mu[5,1]  0.100   0.001 0.107 0.002  0.389 13321.944    1
## mu[5,2]  0.079   0.001 0.085 0.002  0.311 13236.365    1
## mu[6,1]  0.120   0.001 0.131 0.003  0.489 12253.316    1
## mu[6,2]  0.094   0.001 0.103 0.003  0.381 12425.582    1
## mu[7,1]  0.013   0.000 0.013 0.000  0.046 12839.668    1
## mu[7,2]  0.010   0.000 0.010 0.000  0.037 12726.795    1
## mu[8,1]  0.304   0.003 0.286 0.013  1.079 12499.904    1
## mu[8,2]  0.240   0.002 0.227 0.010  0.840 12691.972    1
## mu[9,1]  0.033   0.000 0.032 0.001  0.120 12449.077    1
## mu[9,2]  0.026   0.000 0.026 0.001  0.095 12803.333    1
## mu[10,1] 1.045   0.002 0.245 0.644  1.599 10223.025    1
## mu[10,2] 0.824   0.002 0.191 0.503  1.250 12519.448    1
## mu[11,1] 0.302   0.003 0.286 0.013  1.072 12011.363    1
## mu[11,2] 0.238   0.002 0.227 0.010  0.837 12166.721    1
## mu[12,1] 0.021   0.000 0.022 0.000  0.081 12903.994    1
## mu[12,2] 0.017   0.000 0.017 0.000  0.063 12735.318    1
## mu[13,1] 7.668   0.014 1.318 5.509 10.646  8913.679    1
## mu[13,2] 6.034   0.008 0.974 4.411  8.168 13198.043    1
## mu[14,1] 0.119   0.000 0.020 0.084  0.161 10068.020    1
## mu[14,2] 0.094   0.000 0.016 0.065  0.128 12414.486    1
## mu[15,1] 0.766   0.005 0.541 0.124  2.174 12110.728    1
## mu[15,2] 0.604   0.004 0.426 0.099  1.726 12547.477    1
## mu[16,1] 3.796   0.007 0.659 2.672  5.261  8987.115    1
## mu[16,2] 2.984   0.004 0.469 2.171  4.008 14528.663    1
## mu[17,1] 0.163   0.002 0.181 0.004  0.639 13027.682    1
## mu[17,2] 0.129   0.001 0.143 0.003  0.503 13105.373    1
## mu[18,1] 3.315   0.011 1.099 1.751  5.926  9633.229    1
## mu[18,2] 2.615   0.008 0.872 1.371  4.770 10895.124    1
## mu[19,1] 3.927   0.008 0.712 2.761  5.546  8701.826    1
## mu[19,2] 3.097   0.005 0.567 2.169  4.381 11502.035    1
## mu[20,1] 0.119   0.001 0.069 0.026  0.292 12473.216    1
## mu[20,2] 0.094   0.000 0.055 0.020  0.226 12503.220    1</code></pre>
<p><code>mu[1,1]</code> corresponds to the expected catch rate at site 1 with gear type 1. <code>mu[1,2]</code> corresponds to the expected catch rate at site 1 with gear type 2. <code>mu[2,1]</code> corresponds to the expected catch rate at site 2 with gear type 1.</p>
<p>We can also use functions from the <code>bayesplot</code> package to examine the posterior distributions and chain convergence.</p>
<p>First let’s look at the posterior distribution for <span class="math inline">\(p_{10}\)</span>.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="usecase3.html#cb84-1" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb84-2"><a href="usecase3.html#cb84-2" tabindex="-1"></a></span>
<span id="cb84-3"><a href="usecase3.html#cb84-3" tabindex="-1"></a><span class="co"># plot posterior distribution, highlighting median and 80% credibility interval</span></span>
<span id="cb84-4"><a href="usecase3.html#cb84-4" tabindex="-1"></a><span class="fu">mcmc_areas</span>(<span class="fu">as.matrix</span>(greencrab.fit.q.negbin<span class="sc">$</span>model), <span class="at">pars =</span> <span class="st">&#39;p10&#39;</span>, <span class="at">prob =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<p>Next let’s look at chain convergence for <span class="math inline">\(p_{10}\)</span> and <span class="math inline">\(\beta\)</span>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="usecase3.html#cb85-1" tabindex="-1"></a><span class="co"># this will plot the MCMC chains for p10 and mu at site 1</span></span>
<span id="cb85-2"><a href="usecase3.html#cb85-2" tabindex="-1"></a><span class="fu">mcmc_trace</span>(rstan<span class="sc">::</span><span class="fu">extract</span>(greencrab.fit.q.negbin<span class="sc">$</span>model, <span class="at">permuted =</span> <span class="cn">FALSE</span>), </span>
<span id="cb85-3"><a href="usecase3.html#cb85-3" tabindex="-1"></a>           <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&#39;p10&#39;</span>, <span class="st">&#39;beta&#39;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
</div>
<div id="effort-necessary-to-detect-presence-2" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Effort necessary to detect presence<a href="usecase3.html#effort-necessary-to-detect-presence-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To further highlight these results, we can use <code>detectionCalculate()</code> to find the units of survey effort necessary to detect presence of the species. This function is finding the median number of survey units necessary to detect species presence if the expected catch rate, <span class="math inline">\(\mu\)</span> is 0.1, 0.5, or 1. <span class="math inline">\(\mu\)</span> now represents the expected catch rate of gear type 1.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="usecase3.html#cb86-1" tabindex="-1"></a><span class="fu">detectionCalculate</span>(greencrab.fit.q.negbin<span class="sc">$</span>model, <span class="at">mu =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="dv">1</span>), </span>
<span id="cb86-2"><a href="usecase3.html#cb86-2" tabindex="-1"></a>                   <span class="at">probability =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>##       mu n_traditional_1 n_traditional_2 n_eDNA
## [1,] 0.1              25              31     28
## [2,] 0.5               6               8      6
## [3,] 1.0               4               5      4</code></pre>
<p>We can see that it takes 27 eDNA samples, 25 trap samples (gear type 1), and 31 trap samples (gear type 2) to detect green crab presence with 0.9 probability if the expected catch rate with gear type 1 is 0.1.</p>
<p>We can also plot these comparisons. <code>mu.min</code> and <code>mu.max</code> define the x-axis in the plot and represent the expected catch rate of gear type 1.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="usecase3.html#cb88-1" tabindex="-1"></a><span class="fu">detectionPlot</span>(greencrab.fit.q.negbin<span class="sc">$</span>model, <span class="at">mu.min =</span> <span class="fl">0.1</span>, </span>
<span id="cb88-2"><a href="usecase3.html#cb88-2" tabindex="-1"></a>              <span class="at">mu.max =</span> <span class="dv">1</span>, <span class="at">probability =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
</div>
<div id="calculate-mu_critical-2" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Calculate <span class="math inline">\(\mu_{critical}\)</span><a href="usecase3.html#calculate-mu_critical-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s calculate <span class="math inline">\(\mu_{critical}\)</span>, which is the value of <span class="math inline">\(\mu\)</span> where the probability of a false positive eDNA detection equals the probability of a true positive eDNA detection.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="usecase3.html#cb89-1" tabindex="-1"></a><span class="fu">muCritical</span>(greencrab.fit.q.negbin<span class="sc">$</span>model, <span class="at">cov.val =</span> <span class="cn">NULL</span>, <span class="at">ci =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>##              gear_1      gear_2
## median   0.06008454 0.047477497
## lower_ci 0.01024929 0.007951609
## upper_ci 0.13458086 0.105297563</code></pre>
<p>This function calculates <span class="math inline">\(\mu_{critical}\)</span> using the entire posterior distributions of parameters from the model, and ‘HDI’ corresponds to the 90% credibility interval calculated using the highest density interval. The first column corresponds to <span class="math inline">\(\mu_{critical}\)</span> if gear type 1 is used, and the second columns corresponds to <span class="math inline">\(\mu_{critical}\)</span> if gear type 2 is used.</p>
</div>
</div>
<div id="traditionalmodel" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> traditionalModel()<a href="usecase3.html#traditionalmodel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In some circumstances, it may be helpful to model just the traditional survey data without eDNA data for comparison. Use <code>traditionalModel</code> here, which requires the following parameters:</p>
<ol style="list-style-type: decimal">
<li>data: list of <code>count</code> and (optionally) <code>count.type</code> matrices</li>
<li>family: probability distribution used to model the trap count data. A negative binomial distribution is chosen here.</li>
<li>q: logical value indicating the presence of multiple traditional gear types.</li>
</ol>
<p>More parameters exist to further customize the MCMC sampling, but we’ll stick with the defaults.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="usecase3.html#cb91-1" tabindex="-1"></a><span class="co"># run the traditional model model with gear scaling coefficients</span></span>
<span id="cb91-2"><a href="usecase3.html#cb91-2" tabindex="-1"></a>greencrab.traditional <span class="ot">&lt;-</span> <span class="fu">traditionalModel</span>(<span class="at">data =</span> greencrabData, </span>
<span id="cb91-3"><a href="usecase3.html#cb91-3" tabindex="-1"></a>                                          <span class="at">family =</span> <span class="st">&#39;negbin&#39;</span>, <span class="at">q =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
</div>
<div id="initialvalues3" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Initial values<a href="usecase3.html#initialvalues3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By default, <code>eDNAjoint</code> will provide initial values for parameters estimated by the model, but you can provide your own initial values if you prefer. Here is an example of providing initial values for parameters, <code>mu</code>,<code>p10</code>, <code>beta</code>, and <code>q</code>, as an input in <code>jointModel()</code>.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="usecase3.html#cb92-1" tabindex="-1"></a><span class="co"># set number of chains</span></span>
<span id="cb92-2"><a href="usecase3.html#cb92-2" tabindex="-1"></a>n.chain <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb92-3"><a href="usecase3.html#cb92-3" tabindex="-1"></a></span>
<span id="cb92-4"><a href="usecase3.html#cb92-4" tabindex="-1"></a><span class="co"># initial values should be a list of named lists</span></span>
<span id="cb92-5"><a href="usecase3.html#cb92-5" tabindex="-1"></a>inits <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb92-6"><a href="usecase3.html#cb92-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.chain){</span>
<span id="cb92-7"><a href="usecase3.html#cb92-7" tabindex="-1"></a>  inits[[i]] <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb92-8"><a href="usecase3.html#cb92-8" tabindex="-1"></a>    <span class="co"># length should equal the number of sites (dim(greencrabData$count)[1]) for each chain</span></span>
<span id="cb92-9"><a href="usecase3.html#cb92-9" tabindex="-1"></a>    <span class="at">mu =</span> stats<span class="sc">::</span><span class="fu">runif</span>(<span class="fu">dim</span>(greencrabData<span class="sc">$</span>count)[<span class="dv">1</span>], <span class="fl">0.01</span>, <span class="dv">5</span>), </span>
<span id="cb92-10"><a href="usecase3.html#cb92-10" tabindex="-1"></a>    <span class="co"># length should equal 1 for each chain </span></span>
<span id="cb92-11"><a href="usecase3.html#cb92-11" tabindex="-1"></a>    <span class="at">p10 =</span> stats<span class="sc">::</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.0001</span>,<span class="fl">0.08</span>),</span>
<span id="cb92-12"><a href="usecase3.html#cb92-12" tabindex="-1"></a>    <span class="co"># length should equal 1 for each chain </span></span>
<span id="cb92-13"><a href="usecase3.html#cb92-13" tabindex="-1"></a>    <span class="at">beta =</span> stats<span class="sc">::</span><span class="fu">runif</span>(<span class="dv">1</span>,<span class="fl">0.05</span>,<span class="fl">0.2</span>),</span>
<span id="cb92-14"><a href="usecase3.html#cb92-14" tabindex="-1"></a>    <span class="co"># length should equal the number of gear types - 1</span></span>
<span id="cb92-15"><a href="usecase3.html#cb92-15" tabindex="-1"></a>    <span class="at">q =</span> stats<span class="sc">::</span><span class="fu">runif</span>(</span>
<span id="cb92-16"><a href="usecase3.html#cb92-16" tabindex="-1"></a>      <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">unique</span>(<span class="fu">as.vector</span>(greencrabData<span class="sc">$</span>count.type))))<span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb92-17"><a href="usecase3.html#cb92-17" tabindex="-1"></a>      <span class="fl">0.5</span>, <span class="fl">1.5</span></span>
<span id="cb92-18"><a href="usecase3.html#cb92-18" tabindex="-1"></a>      )</span>
<span id="cb92-19"><a href="usecase3.html#cb92-19" tabindex="-1"></a>    )</span>
<span id="cb92-20"><a href="usecase3.html#cb92-20" tabindex="-1"></a>}</span>
<span id="cb92-21"><a href="usecase3.html#cb92-21" tabindex="-1"></a></span>
<span id="cb92-22"><a href="usecase3.html#cb92-22" tabindex="-1"></a><span class="co"># now fit the model</span></span>
<span id="cb92-23"><a href="usecase3.html#cb92-23" tabindex="-1"></a>fit.w.inits <span class="ot">&lt;-</span> <span class="fu">jointModel</span>(<span class="at">data =</span> greencrabData, </span>
<span id="cb92-24"><a href="usecase3.html#cb92-24" tabindex="-1"></a>                          <span class="at">q =</span> <span class="cn">TRUE</span>, <span class="at">initial_values =</span> inits)</span></code></pre></div>
<pre><code>## 
## SAMPLING FOR MODEL &#39;joint_binary_catchability_pois&#39; NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 0.004588 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 45.88 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:    1 / 3000 [  0%]  (Warmup)
## Chain 1: Iteration:  500 / 3000 [ 16%]  (Warmup)
## Chain 1: Iteration:  501 / 3000 [ 16%]  (Sampling)
## Chain 1: Iteration: 1000 / 3000 [ 33%]  (Sampling)
## Chain 1: Iteration: 1500 / 3000 [ 50%]  (Sampling)
## Chain 1: Iteration: 2000 / 3000 [ 66%]  (Sampling)
## Chain 1: Iteration: 2500 / 3000 [ 83%]  (Sampling)
## Chain 1: Iteration: 3000 / 3000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 4.498 seconds (Warm-up)
## Chain 1:                10.422 seconds (Sampling)
## Chain 1:                14.92 seconds (Total)
## Chain 1: 
## 
## SAMPLING FOR MODEL &#39;joint_binary_catchability_pois&#39; NOW (CHAIN 2).
## Chain 2: 
## Chain 2: Gradient evaluation took 0.00054 seconds
## Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 5.4 seconds.
## Chain 2: Adjust your expectations accordingly!
## Chain 2: 
## Chain 2: 
## Chain 2: Iteration:    1 / 3000 [  0%]  (Warmup)
## Chain 2: Iteration:  500 / 3000 [ 16%]  (Warmup)
## Chain 2: Iteration:  501 / 3000 [ 16%]  (Sampling)
## Chain 2: Iteration: 1000 / 3000 [ 33%]  (Sampling)
## Chain 2: Iteration: 1500 / 3000 [ 50%]  (Sampling)
## Chain 2: Iteration: 2000 / 3000 [ 66%]  (Sampling)
## Chain 2: Iteration: 2500 / 3000 [ 83%]  (Sampling)
## Chain 2: Iteration: 3000 / 3000 [100%]  (Sampling)
## Chain 2: 
## Chain 2:  Elapsed Time: 4.611 seconds (Warm-up)
## Chain 2:                11.633 seconds (Sampling)
## Chain 2:                16.244 seconds (Total)
## Chain 2: 
## 
## SAMPLING FOR MODEL &#39;joint_binary_catchability_pois&#39; NOW (CHAIN 3).
## Chain 3: 
## Chain 3: Gradient evaluation took 0.000255 seconds
## Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 2.55 seconds.
## Chain 3: Adjust your expectations accordingly!
## Chain 3: 
## Chain 3: 
## Chain 3: Iteration:    1 / 3000 [  0%]  (Warmup)
## Chain 3: Iteration:  500 / 3000 [ 16%]  (Warmup)
## Chain 3: Iteration:  501 / 3000 [ 16%]  (Sampling)
## Chain 3: Iteration: 1000 / 3000 [ 33%]  (Sampling)
## Chain 3: Iteration: 1500 / 3000 [ 50%]  (Sampling)
## Chain 3: Iteration: 2000 / 3000 [ 66%]  (Sampling)
## Chain 3: Iteration: 2500 / 3000 [ 83%]  (Sampling)
## Chain 3: Iteration: 3000 / 3000 [100%]  (Sampling)
## Chain 3: 
## Chain 3:  Elapsed Time: 4.064 seconds (Warm-up)
## Chain 3:                7.981 seconds (Sampling)
## Chain 3:                12.045 seconds (Total)
## Chain 3: 
## 
## SAMPLING FOR MODEL &#39;joint_binary_catchability_pois&#39; NOW (CHAIN 4).
## Chain 4: 
## Chain 4: Gradient evaluation took 0.00016 seconds
## Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 1.6 seconds.
## Chain 4: Adjust your expectations accordingly!
## Chain 4: 
## Chain 4: 
## Chain 4: Iteration:    1 / 3000 [  0%]  (Warmup)
## Chain 4: Iteration:  500 / 3000 [ 16%]  (Warmup)
## Chain 4: Iteration:  501 / 3000 [ 16%]  (Sampling)
## Chain 4: Iteration: 1000 / 3000 [ 33%]  (Sampling)
## Chain 4: Iteration: 1500 / 3000 [ 50%]  (Sampling)
## Chain 4: Iteration: 2000 / 3000 [ 66%]  (Sampling)
## Chain 4: Iteration: 2500 / 3000 [ 83%]  (Sampling)
## Chain 4: Iteration: 3000 / 3000 [100%]  (Sampling)
## Chain 4: 
## Chain 4:  Elapsed Time: 5.36 seconds (Warm-up)
## Chain 4:                7.099 seconds (Sampling)
## Chain 4:                12.459 seconds (Total)
## Chain 4: 
## Refer to the eDNAjoint guide for visualization tips:  https://bookdown.org/abigailkeller/eDNAjoint_vignette/tips.html#visualization-tips</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="usecase3.html#cb94-1" tabindex="-1"></a><span class="co"># check to see the initial values that were used</span></span>
<span id="cb94-2"><a href="usecase3.html#cb94-2" tabindex="-1"></a>fit.w.inits<span class="sc">$</span>inits</span></code></pre></div>
<pre><code>## $chain1
## $chain1$mu_trad_1
##  [1] 4.0780805 1.6461503 1.8409625 3.8067218 4.8467818 4.9285195 4.9491822 2.6502479
##  [9] 1.7250343 4.7976077 3.8983880 0.6046407 1.7905315 3.2753873 3.6891999 0.9293645
## [17] 1.8348874 3.5736912 2.1752346 4.3831472
## 
## $chain1$mu
##  [1] 4.0780805 1.6461503 1.8409625 3.8067218 4.8467818 4.9285195 4.9491822 2.6502479
##  [9] 1.7250343 4.7976077 3.8983880 0.6046407 1.7905315 3.2753873 3.6891999 0.9293645
## [17] 1.8348874 3.5736912 2.1752346 4.3831472
## 
## $chain1$log_p10
## [1] -3.650117
## 
## $chain1$beta
## [1] 0.08127231
## 
## $chain1$q_trans
##   initial_values[[i]]$q
## 1              0.601305
## 
## 
## $chain2
## $chain2$mu_trad_1
##  [1] 1.4338101 2.5878397 2.8904753 2.7515258 0.9257917 3.3239880 0.4693585 4.9146158
##  [9] 0.2296816 3.2920709 4.7342723 4.4256445 0.5334799 1.5910902 4.5501773 3.0226411
## [17] 0.2046510 3.9737262 1.3052055 2.0850422
## 
## $chain2$mu
##  [1] 1.4338101 2.5878397 2.8904753 2.7515258 0.9257917 3.3239880 0.4693585 4.9146158
##  [9] 0.2296816 3.2920709 4.7342723 4.4256445 0.5334799 1.5910902 4.5501773 3.0226411
## [17] 0.2046510 3.9737262 1.3052055 2.0850422
## 
## $chain2$log_p10
## [1] -3.596207
## 
## $chain2$beta
## [1] 0.05520817
## 
## $chain2$q_trans
##   initial_values[[i]]$q
## 1             0.7872615
## 
## 
## $chain3
## $chain3$mu_trad_1
##  [1] 4.8505518 4.0163179 0.8375390 3.9024871 4.8707274 4.8644647 4.3380319 1.6399283
##  [9] 4.1358120 4.8363555 1.4619399 1.1389638 4.9408612 1.4267285 3.9601021 4.6860420
## [17] 1.7089668 0.8324854 1.2504033 0.7275175
## 
## $chain3$mu
##  [1] 4.8505518 4.0163179 0.8375390 3.9024871 4.8707274 4.8644647 4.3380319 1.6399283
##  [9] 4.1358120 4.8363555 1.4619399 1.1389638 4.9408612 1.4267285 3.9601021 4.6860420
## [17] 1.7089668 0.8324854 1.2504033 0.7275175
## 
## $chain3$log_p10
## [1] -3.799006
## 
## $chain3$beta
## [1] 0.1855994
## 
## $chain3$q_trans
##   initial_values[[i]]$q
## 1             0.5643277
## 
## 
## $chain4
## $chain4$mu_trad_1
##  [1] 2.7554272 4.0679301 0.1415597 4.3108366 0.1804336 4.6816822 4.4900137 2.9730838
##  [9] 0.1707672 3.6851893 1.6473768 1.9190297 4.9792169 0.7193204 0.7521687 2.7401448
## [17] 2.4927889 1.0740960 4.6347019 3.2124127
## 
## $chain4$mu
##  [1] 2.7554272 4.0679301 0.1415597 4.3108366 0.1804336 4.6816822 4.4900137 2.9730838
##  [9] 0.1707672 3.6851893 1.6473768 1.9190297 4.9792169 0.7193204 0.7521687 2.7401448
## [17] 2.4927889 1.0740960 4.6347019 3.2124127
## 
## $chain4$log_p10
## [1] -2.790357
## 
## $chain4$beta
## [1] 0.1484974
## 
## $chain4$q_trans
##   initial_values[[i]]$q
## 1              1.232433</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="usecase2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="usecase4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
